# MAL-ICS++ Dataset Documentation

## Overview

The MAL-ICS++ dataset is a comprehensive power grid cybersecurity dataset for evaluating False Data Injection Attack (FDIA) detection systems. It contains 10,010 samples from IEEE 14-bus power system simulations under normal and attack scenarios.

## Dataset Specifications

- **Total Samples**: 10,010
- **Normal Samples**: 5,010 (50%)
- **Attack Samples**: 5,000 (50%, distributed across 5 attack types)
- **Features**: 115 total
  - 108 power grid measurements
  - 7 metadata fields
- **Power System**: IEEE 14-bus test system
- **Simulator**: Pandapower 3.2.1
- **Format**: CSV (malics_dataset_complete.csv)

## Class Distribution

| Class | Type | Samples | Percentage |
|-------|------|---------|------------|
| Normal | Baseline Operation | 5,010 | 50% |
| A1 | MITM Attack | 1,000 | 10% |
| A2 | Topology Poisoning | 1,000 | 10% |
| A3 | Sensor Compromise | 1,000 | 10% |
| A4 | Coordinated Multi-Bus | 1,000 | 10% |
| A5 | Stealth FDIA | 1,000 | 10% |

## Feature Categories

### 1. Voltage Magnitudes (14 features)
Bus voltage magnitudes in per-unit (p.u.)
- `vm_pu_bus_0` to `vm_pu_bus_13`
- Range: typically 0.95 - 1.05 p.u.
- Normal operation: ≈1.0 p.u.

### 2. Voltage Angles (14 features)
Bus voltage phase angles in degrees
- `va_degree_bus_0` to `va_degree_bus_13`
- Range: -15° to +15° (slack bus = 0°)
- Attack indicator: abnormal angle differences

### 3. Active Power Flows (20 features)
Real power flows through transmission lines (MW)
- `p_from_mw_line_0` to `p_from_mw_line_19`
- Positive: power flowing from-to
- Negative: power flowing to-from

### 4. Reactive Power Flows (20 features)
Reactive power flows through lines (MVAr)
- `q_from_mvar_line_0` to `q_from_mvar_line_19`
- Critical for voltage stability
- Attacks often manifest as reactive power anomalies

### 5. Line Currents (20 features)
Current magnitudes in transmission lines (kA)
- `i_ka_line_0` to `i_ka_line_19`
- Thermal limit constraints
- Overload indicator during attacks

### 6. Bus Power Injections (20 features)
Net active and reactive power at each bus
- `p_mw_bus_0` to `p_mw_bus_13` (active)
- `q_mvar_bus_0` to `q_mvar_bus_13` (reactive)
- Balance equation: generation - load

### 7. Metadata (7 features)
- `timestamp`: Unix timestamp of sample generation
- `load_factor`: System loading (0.7-1.3)
- `label`: Attack class (Normal/A1/A2/A3/A4/A5)
- `attack_type`: Human-readable attack name
- `attack_target`: Targeted bus/line
- `attack_magnitude`: Injection magnitude (%)
- `sample_id`: Unique identifier

## Attack Type Descriptions

### A1: Man-in-the-Middle (MITM) Attack
**Description**: Adversary intercepts communication between SCADA and RTU, modifying measurements before forwarding to control center.

**Characteristics**:
- Targets specific buses (3-5 buses)
- Measurement modifications: ±5-15%
- Time-synchronized injection
- Evades bad data detection (BDD)

**Detection Challenge**: Low-magnitude, coordinated injections

**Generated by**: `src/dataset/generate_attack_a1.py`

---

### A2: Topology Poisoning
**Description**: False circuit breaker status reports lead to incorrect topology estimation.

**Characteristics**:
- Targets line switching status
- Creates phantom lines or removes real lines
- Causes state estimator errors
- Impacts power flow calculations

**Detection Challenge**: Infrequent events, difficult to distinguish from legitimate switching

**Generated by**: `src/dataset/generate_attack_a2.py`

---

### A3: Sensor Compromise
**Description**: Direct manipulation of sensor readings through firmware/hardware compromise.

**Characteristics**:
- Persistent sensor bias injection
- Can target voltage, current, or power sensors
- Magnitude: ±10-20%
- Difficult to detect with traditional residual analysis

**Detection Challenge**: Appears as sensor drift, hard to distinguish from calibration errors

**Generated by**: `src/dataset/generate_attack_a3.py`

---

### A4: Coordinated Multi-Bus Attack
**Description**: Simultaneous attacks on multiple buses to maximize impact and evade detection.

**Characteristics**:
- 4-6 buses targeted simultaneously
- Coordinated injection patterns
- Leverages power flow Jacobian knowledge
- Designed to bypass residual thresholds

**Detection Challenge**: Sophisticated, requires knowledge of system topology and parameters

**Generated by**: `src/dataset/generate_attack_a4.py`

---

### A5: Stealth FDIA
**Description**: Minimal-magnitude attacks designed to stay below detection thresholds.

**Characteristics**:
- Very low injection magnitudes (±3-8%)
- Long-duration campaigns
- Gradual system degradation
- Highest evasion capability

**Detection Challenge**: Near-normal operation, requires advanced anomaly detection

**Generated by**: `src/dataset/generate_attack_a5.py`

## Data Generation Process

1. **Base System**: IEEE 14-bus system loaded from Pandapower
2. **Normal Operation**: Random load variations (70-130% nominal)
3. **Power Flow**: AC power flow solver (Newton-Raphson)
4. **Attack Injection**: Class-specific perturbation patterns
5. **Measurement Extraction**: 108 power grid features
6. **Metadata Addition**: Labels, timestamps, attack parameters

## Usage Example

```python
import pandas as pd

# Load dataset
df = pd.read_csv('data/processed/malics_dataset_complete.csv')

# Check class distribution
print(df['label'].value_counts())

# Filter attack samples only
attacks = df[df['label'] != 'Normal']

# Extract voltage features
voltage_cols = [col for col in df.columns if 'vm_pu' in col]
voltages = df[voltage_cols]

# Split features and labels
X = df.drop(['label', 'timestamp', 'attack_type'], axis=1)
y = df['label']
```

## Data Quality

- **Missing Values**: <0.1% (handled via median imputation)
- **Outliers**: Physically constrained (voltage: 0.9-1.1 p.u.)
- **Balance**: Equal attack class representation (1,000 each)
- **Diversity**: Multiple load conditions, attack scenarios

## Citation

If you use this dataset, please cite:

```bibtex
@dataset{malics2026dataset,
  title={MAL-ICS++: A Multi-Layer Malware-Resilient Dataset for FDIA Detection},
  author={[Authors]},
  year={2026},
  publisher={GitHub},
  howpublished={\url{https://github.com/yourusername/malics-plusplus}}
}
```

## Ethical Considerations

This dataset is intended for **research purposes only**. It should not be used to:
- Develop malicious attack tools
- Compromise real power grid systems
- Violate critical infrastructure security policies

Users must comply with local cybersecurity laws and ethical guidelines.

## Updates and Versioning

- **v1.0** (2026-02-12): Initial release with 10,010 samples
- Future versions may include:
  - IEEE 30/57/118-bus systems
  - Additional attack types (e.g., GPS spoofing, relay attacks)
  - Time-series sequential data

## Contact

For questions, issues, or dataset requests:
- GitHub Issues: [Repository Issues](https://github.com/yourusername/malics-plusplus/issues)
- Email: [your-email@institution.edu]
